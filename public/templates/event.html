<ol class="breadcrumb">
    <li><a href="/#!/events">Événements</a></li>
    <li class="active">Détail de l'événement</li>
</ol>

<h1>{{ event.sport.name }} {{event.gender | gender}}</h1>
<p>Date: {{event.dateAsString | date:'dd-MM-yyyy HH:mm'}}</p>

<h2>Billets</h2>
<table class="table">
    <thead>
    <tr>
        <th>Prix</th>
        <th>Billets disponibles</th>
        <th>Type</th>
        <th>Section</th>
        <th>Siège</th>
        <th>Quantité</th>
    </tr>
    </thead>
    <tbody>
    <tr class="category" ng-repeat="category in event.categories">
        <td class="price">{{category.price}}$</td>
        <td class="numberOfTickets">{{category.numberOfTickets}}</td>
        <td>
            <p>{{category.type | categoryType}}</p>
        </td>

        <td>
            <ANY ng-switch="category.type">
                <ANY ng-switch-when="SEAT">
                    <select id="{{sectionsByCategories[category.id].name}}"
                            class="form-control"
                            ng-change="apiCall()"
                            ng-model="sectionsByCategories[category.id].value"
                            ng-options="s for s in sectionsByCategories[category.id].values"
                        <option value="">Section...</option>
                    </select>
                </ANY>
                <ANY ng-switch-when="GENERAL_ADMISSION">
                    <select id="generalSection"
                            class="form-control" disabled=true>
                        <option value="">---</option>
                    </select>
                </ANY>
                <ANY ng-switch-default>---</ANY>
            </ANY>
        </td>
        <td>
            <ANY ng-switch="category.type">
                <ANY ng-switch-when="SEAT">
                    <select id="{{ticketsByCategories[category.id].name}}"
                            class="form-control"
                            ng-model="ticketsByCategories[category.id].value">
                        <option value="">Siège disponible...</option>
                        <option value="{{ticket.id}}"
                                ng-repeat="ticket in ticketsByCategories[category.id].values">
                            {{ticket.seat}}
                        </option>
                    </select>
                </ANY>
                <ANY ng-switch-when="GENERAL_ADMISSION">
                    <select id="generalSeat"
                            class="form-control" disabled=true>
                        <option value="">---</option>
                    </select>
                </ANY>
                <ANY ng-switch-default>---</ANY>
            </ANY>
        </td>
        <td>
            <ANY ng-switch="category.type">
                <ANY ng-switch-when="GENERAL_ADMISSION">
                    <input type="number" step="1" ng-model="quantity[category.id]" ng-init="quantity[category.id]=1"
                           class="form-control category-quantity" min="1" max="{{category.numberOfTickets}}"
                           ng-disabled="category.numberOfTickets == 0">
                </ANY>
                <ANY ng-switch-when="SEAT">
                    <input type="number"
                           class="form-control category-quantity" value="1" disabled=true>
                </ANY>
                <ANY ng-switch-default>---</ANY>
            </ANY>
        </td>
        <td>
            <button class="btn btn-success category-add"
                    ng-click="addToCart(ticketsByCategories[category.id].value, category, quantity[category.id])"
                    ng-hide="category.numberOfTickets == 0"
                    ng-disabled="!ticketsByCategories[category.id].value && category.type == 'SEAT'">
                Ajouter au panier
            </button>
            <a href="/#!/tickets/{{ticketsByCategories[category.id].value}}"
               ng-disabled="!ticketsByCategories[category.id].value && category.type == 'SEAT'"
               ng-hide="category.type == 'GENERAL_ADMISSION'"
               class="btn btn-info">
                Détails
            </a>
        </td>
    </tr>
    </tbody>
</table>
